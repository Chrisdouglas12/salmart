<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Request</title>
</head>
<body>
  <!-- Request Feed Section -->
<div class="request-feed-container">
  <div id="create-request" class="create-request">
    <textarea placeholder="What do you want to buy?" id="request-input"></textarea>
    <div class="request-actions">
      <button id="submit-request">Post Request</button>
    </div>
  </div>

  <div id="request-feed" class="request-feed">
    <!-- Requests will be displayed here -->
  </div>
</div>



  <style>
.create-request {
  background: white;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  margin-bottom: 15px;
  font-family: 'Poppins', sans-serif;
}

.create-request textarea {
  width: 100%;
  border: none;
  resize: none;
  font-size: 14px;
  padding: 10px;
  border-radius: 8px;
  background: #f0f2f5;
  outline: none;
}

.request-actions {
  display: flex;
  justify-content: flex-end;
  margin-top: 10px;
}

.request-actions button {
  background-color: #28a745;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 20px;
  cursor: pointer;
  font-size: 14px;
}


  </style>
  <script>
  const submitBtn = document.getElementById('submit-request');
  const requestInput = document.getElementById('request-input');

  // Handle posting a new request
  submitBtn.addEventListener('click', async () => {
    const requestText = requestInput.value.trim();
    
    if (!requestText) return alert('Please write a request!');

    const newRequest = {
      text: requestText,
      category: 'General',  // You can add a category field here later
      budget: 1000,         // Example budget
      location: 'Lagos'    // Example location
    };

    try {
      const API_BASE_URL =
      window.location.hostname === 'localhost'
      ? 'http://localhost:3000'
      :
'https://salmart-production.up.railway.app'
      const response = await fetch(`${API_BASE_URL}/create-request`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${localStorage.getItem('authToken')}`
        },
        body: JSON.stringify(newRequest)
      });

      if (response.ok) {
        const savedRequest = await response.json();
        requestInput.value = ''; // Clear the input
        window.location.href = 'index.html'; // Redirect to index.html after request is created
      } else {
        alert('Error posting request.');
      }
    } catch (err) {
      console.error('Error posting request:', err);
    }
  });
</script>
</body>
</html>